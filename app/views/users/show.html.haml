%h2.page_title 
  -if @current_user.is_admin? && current_object != @current_user
    See a user account
  -else
    My account

%p
  %span.key Login: 
  %span.value= h current_object.login
%p
  %span.key Name: 
  %span.value= h current_object.name
%p
  %span.key Contact email:
  -if @current_user.is_admin? && current_object != @current_user
    %span.value= mail_to "#{current_object.name} <#{current_object.email}>", current_object.email, :subject => EMAILS_SUBJECT_PREFIX
  -else
    %span.value= h current_object.email
%p 
  %span.key Last login:
  %span.value= current_object.last_login_at ? h(current_object.last_login_at.strftime("%d/%m/%Y at %H:%M")) : "&nbsp;"
%p 
  %span.key Last login IP:
  %span.value= current_object.last_login_ip || "&nbsp;"
%p
  -if @current_user.is_admin? && current_object != @current_user
    %span.key Groups this user belongs to:
  -else
    %span.key Groups you belong to:
  %span.value= group_list(current_object)

-if @current_user.is_admin? && current_object != @current_user
  %p
    = link_to 'Change Password', 'edit_password/'+current_object.perishable_token, :class => "button"
    = link_to "Edit this account", edit_user_path(current_object), :class=> "button"
    = link_to "Delete this account", user_path(current_object), {:confirm => 'Are you sure?', :method => :delete, :class => "alternative_button"}
    
  %p 
    %span.key State:
    %span.value
      %span{:style => "float:right;font-size: 1em"}
        -if ["inactive", "banned", "pending"].include?current_object.state
          = link_to "Activate", activate_user_path(current_object), :method => :put
        -if ["active", "banned", "pending"].include?current_object.state
          = link_to "Inactivate", inactivate_user_path(current_object), :method => :put
        -if ["active", "inactive", "pending"].include?current_object.state
          = link_to "Ban", ban_user_path(current_object), :method => :put
      = format_states(current_object.state)
-else
  %p= link_to "Edit my account", edit_user_path(current_object), :class=> "button"

-if current_object.is_admin?
  %p
    %span.large Your have an administrator account.

-if @current_user.is_admin? && current_object != @current_user
  %h3.subtitle
    The FTP accounts
    %ul
      %li= link_to "Browse all FTP accounts", ftpusers_path
      %li= link_to "Create a new FTP account", new_ftpuser_path

  / .paginate
  /   = will_paginate @ftpusers, :param_name => :ftpusers_page
  = render :partial => "ftpusers/ftpusers_table", :locals => {:current_objects => current_object.ftpusers}
  / .paginate
  /   = will_paginate @ftpusers, :param_name => :ftpusers_page

  -if current_user.is_admin?
    %h3.subtitle
      The servers
      %ul
        %li= link_to "Browse all servers", servers_path
        %li= link_to "Create a new server", new_server_path

    / .paginate
    /   = will_paginate @servers, :param_name => :servers_page
    = render :partial => "servers/servers_table", :locals => {:current_objects => current_object.servers}
    / .paginate
    /   = will_paginate @servers, :param_name => :servers_page
  
    %h3.subtitle
      The groups
      %ul
        %li= link_to "Browse all groups", groups_path
        %li= link_to "Create a new group", new_group_path
  
    / .paginate
    /   = will_paginate @groups, :param_name => :groups_page
    = render :partial => "groups/groups_table", :locals => {:current_objects => current_object.groups}
    / .paginate
    /   = will_paginate @groups, :param_name => :groups_page